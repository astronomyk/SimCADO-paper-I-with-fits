\section{Future functionality for SimCADO}
\label{sec:future}

The results of the first verification run show that SimCADO is capable of recreating observations with only descriptions of the optical elements as input. There are, however, still several aspects that require attention by the development team. In short they are:

\paragraph{Atmospheric variations:} SimCADO uses a set of standardised spectra from SkyCalc, scaled to the required background level, to provide the sky background flux for any chosen filter. Currently this atmospheric spectrum is independent of the atmospheric water content (PWV\,=\,2.5\,mm), however it does reflect the airmass. For the verification run described here, these points were not relevant: the archival data for M\,4 were taken close to zenith and the image of NGC\,4147 (airmass $\sim 1.44$) was primarily used as a control for its different exposure length. Functionality to directly connect SimCADO to the ESO SkyCalc service using the SkyCalc-iPy python package (\url{https://skycalc-ipy.readthedocs.io}) will be included in the next release. This will enable the effects of different atmospheric conditions to be include on-the-fly in simulations.

\paragraph{PSF variability:} While not as important for a seeing-limited instrument, the variations in the shape of the PSF over the field of view for observations conducted with adaptive optics is not a trivial effect. We recently included the functionality to include the effects of a field-varying PSFs for the SCAO observation mode over the full field of view in simulations. The currently available set of SCAO PSFs was generated by the AnisoCADO tool. Field-varying MCAO PSFs are not yet publically available. It should be noted that the exposure times are assumed to be long enough that the PSF should not vary significantly between exposures (EXPTIME > 5\,s). Whether or not this assumption holds for all time scales remains to be investigated.

\paragraph{Distortion effects:} For photometric studies optical distortions are a nuisance. For astrometric studies they are critical. SimCADO includes the functionality to shift point sources on the sub-pixel level. As such we are currently investigating the best way to implement the use of distortion maps in the model of the optical train.

\paragraph{Non-common path aberrations:} Only the effective loss in flux due to PSF broadening from the combined set of NCPAs is currently included in SimCADO. This is a function of wavelength and as such can be modelled effectively as an additional transmission curve. The spatial aspects of the NCPAs in the context of the MICADO optical train are currently being investigated, however a first order approximation of the spatial effects is already included in the current development version of the code.

\paragraph{Spectroscopy:} MICADO has been designed to also include optics for a long slit spectrograph. A separate python package, SpecCADO, using the core functionality of SimCADO was created to model the more complex spectroscopy mode\footnote{\url{https://homepage.univie.ac.at/oliver.czoske/}}. The extended functionality of SpecCADO will be merged into the next release version of SimCADO.

Although there is still much work to do, SimCADO is already capable of simulating raw detector read-outs for each of the MICADO imaging modes, using both the SCAO and MCAO adaptive optics configurations. This alone covers the majority of the primary science drivers for MICADO. It should also be noted that MICADO is still in the design phase and so the composition of the optical train, and therefore the default data installed alongside SimCADO, are likely to change in the future. However, given the maturity of the design we foresee no radical changes to the optical system, and thus no radical changes to the sensitivity estimates presented in this paper.


\section{Summary}
\label{sec:conclusions}

As part of the design activities for the MICADO instrument we have developed an instrument data simulator in Python: SimCADO. The software is capable of generating detector frames for any given optical train configuration and source object description. A summary of our activities and results is as follows:

\begin{itemize}

    \item In conjunction with the MICADO instrument team we have developed a modular python package that allows us to model each element in the optical train separately. The software allows the user to fully control the configuration of the optical train as well as the description of the astronomical object to be observed. Images produced by the package are in the standard FITS format and can be treated as coming directly from a telescope.
    
    \item We configured SimCADO to mimic the UT4/HAWK-I optical train and ``observed'' two globular clusters with this setup. A comparison to archive data for the same globular clusters showed that SimCADO is capable of reproducing all the major and most of the minor effects that are seen in raw detector frames from HAWK-I. A photometric comparison shows a one-to-one correlation between the flux observed in the archive and simulated images. Although there is scatter around this line, the primary source of uncertainty lies with the photometric analysis of the archive data and not with the simulated images. Additionally SimCADO is able to reproduce the detection limits given by the ESO exposure time calculator for a 1-hour observation with HAWK-I.
    
    \item Using the configuration for the ELT/MICADO optical train we simulated a grid of stars to find the detection limits for different exposure times. We have shown that the 5\,hour 5$\sigma$ detection limits in AB (Vega) magnitudes are: $J=29.6$\m ($28.7$\m), $H=29.3$\m ($27.9$\m) and $K_{s}=29.1$\m ($27.3$\m), while the saturation limit for the shortest exposure time ($\mathrm{MINDIT}=2.6\,\mathrm{s}$) in the wide-field (4\,mas/pixel) mode are similar to the 2MASS detection limits (Vega): $J=15.9$\m, $H=15.6$\m and $K_{s}=14.8$\m. The use of the zoom mode (1.5\,mas/pixel) in conjunction with a narrow band filter, such as the \brgamma filter, would increase this limit to $\sim 9.9$\m (Vega).

    \item With these detection limits we have shown that MICADO will be capable of detecting individual A0\,V stars at a distance of 4\,Mpc (Centaurus~A), while any star brighter than B1\,V at a distance of 50\,kpc (LMC) will saturate during the a single minimum length exposure.
    
    \item We will be adding the following functionality to SimCADO in the near future: a long slit spectrographic mode, MCAO field variable PSFs, variations in atmospheric conditions.

\end{itemize}

We encourage anyone who may want to use the ELT and MICADO for future observations to use SimCADO to simulate their science case in advance. Not only will this help the community to get a feel for what MICADO will be capable of and where possible problems with an observing strategy will be, feedback from users will help us to develop the software in such a way as to meet the needs of the astronomical community.